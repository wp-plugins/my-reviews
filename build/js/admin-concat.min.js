(function(a){var e=function(){function e(a){var e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(a)}function t(e){0!=_&&_.abort();var t={action:"get_images",email:e,nonce:mr_data.get_images_nonce};return _=a.ajax({type:"POST",url:ajaxurl,data:t,async:!1,success:function(a){a.gravatar!==undefined&&(k.gravatar=a.gravatar),a.gplus!==undefined&&(k.gplus=a.gplus),n()},dataType:"json"})}function n(){k.gravatar?(p.show().find(".gravatar img").attr("src",k.gravatar).show().parent().show(),s.val(k.gravatar),g.fadeIn()):(p.find(".gravatar img").attr("src",""),g.hide(),s.val(""),s.prop("checked",!1)),k.gplus?(p.show().find(".gplus img").attr("src",k.gplus).show().parent().show(),c.val(k.gplus),m.fadeIn()):(p.find(".gplus img").attr("src",""),m.hide(),c.val(""),c.prop("checked",!1)),k.gravatar||k.gplus||(p.fadeOut(),null!=h&&h.hide())}function r(e){e&&(a.ajax({type:"POST",url:ajaxurl,data:{action:"set-post-thumbnail",post_id:a("#post_ID").val(),thumbnail_id:-1,_ajax_nonce:mr_data.set_thumbnail_nonce,cookie:encodeURIComponent(document.cookie)},success:function(a){"0"!=a&&WPSetThumbnailHTML(a)},async:!1}),null===h?(h=a('<p class="hide-if-no-js mr-featured-image"><img src="'+e+'" /></p>'),a("#postimagediv .inside").prepend(h)):(h.find("img").attr("src",e),h.show()))}function i(){var n=wp.media.featuredImage.set;wp.media.featuredImage.set=function(a){n(a),d.val(""),v.val(""),s.prop("checked",!1),c.prop("checked",!1)},t(o.val()),o.on("keyup",function(){clearTimeout(w),e(a(this).val())?w=setTimeout(function(){d.val(""),v.val(""),t(o.val())},1e3):(s.prop("checked",!1),c.prop("checked",!1),d.val(""),v.val(""),null!=h&&h.hide(),p.hide())}),"0"==mr_data.thumbnail_id||-1==mr_data.thumbnail_id?s.is(":checked")?(r(s.val()+"?s=200"),v.val("gravatar"),d.val(s.val())):c.is(":checked")?(r(c.val()+"?sz=200"),v.val("gplus"),d.val(c.val())):null!=h&&h.hide():(s.prop("checked",!1),c.prop("checked",!1)),f=p.find("input[type=checkbox]"),p.on("change","input[type=checkbox]",function(){var e=a(this);f.each(function(){e[0]!=a(this)[0]&&a(this).prop("checked",!1)}),e.is(":checked")?("mr_use_gravatar"==e.attr("name")?(r(e.val()+"?s=200"),v.val("gravatar")):"mr_use_gplus"==e.attr("name")&&(r(e.val()+"?sz=200"),v.val("gplus")),d.val(e.val())):(d.val(""),v.val(""),null!=h&&h.hide())})}function l(){return u||(u=new i),u}var u,s=a("input[name=mr_use_gravatar]"),c=a("input[name=mr_use_gplus]"),o=a("#mr_email"),p=a(".mr-external-images"),d=p.find("input[name=mr_reviewer_image]"),v=p.find("input[name=mr_reviewer_image_type]"),g=p.find(".gravatar-row"),m=p.find(".gplus-row"),h=null,f=null,_=!1,k={gravatar:!1,gplus:!1},w=!1;return{get_instance:l}}();e.get_instance()})(jQuery);